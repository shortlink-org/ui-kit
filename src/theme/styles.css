@import 'tailwindcss';

/* CSS Variables for Theme Colors (Tailwind v4 approach) */
:root {
  /* Spring easing functions using CSS linear() for natural animations */
  /* @see https://motion.dev/tutorials/react-css-spring */
  --spring-snappy: 0.3s linear(0, 0.009, 0.035 2.1%, 0.141 4.4%, 0.723 12.9%, 0.938, 1.077 20.4%, 1.121, 1.149 24.3%, 1.159, 1.163 27%, 1.154 29.9%, 1.129 33%, 1.051 39.6%, 1.017 43.1%, 0.991, 0.977 51%, 0.974 53.8%, 0.975 57.1%, 0.997 69.8%, 1.003 76.9%, 1);
  --spring-default: 0.4s linear(0, 0.006, 0.025 2.8%, 0.101 6.1%, 0.539 18.9%, 0.721 25%, 0.849 31.5%, 0.937 38.9%, 0.968 43.2%, 0.994 48.2%, 1.009 53.6%, 1.017 59.3%, 1.018 65.2%, 1.007 81.2%, 1);
  --spring-bouncy: 0.5s linear(0, 0.004, 0.016, 0.035, 0.063 9.1%, 0.141 13.6%, 0.527, 0.66 27.3%, 0.824 36.4%, 0.879, 0.92, 0.949 50%, 0.966, 0.978 59.1%, 0.984 63.6%, 0.986 68.2%, 0.983 72.7%, 0.977, 0.97 81.8%, 0.965 90.9%, 0.97, 0.979, 0.992, 1);
  --spring-wobbly: 0.6s linear(0, 0.003, 0.012, 0.027 5.6%, 0.109 11.1%, 0.381, 0.506 22.2%, 0.713 33.3%, 0.818, 0.886, 0.926, 0.949 50%, 0.965, 0.976, 0.98, 0.981 61.1%, 0.978, 0.973 66.7%, 0.968, 0.967 72.2%, 0.971, 0.979 83.3%, 0.986, 0.997, 1);
  --spring-gentle: 0.5s linear(0, 0.007, 0.029 2.2%, 0.118 4.7%, 0.625 14.4%, 0.826 19.3%, 0.902, 0.962 25.5%, 1.006 29.8%, 1.037 34.4%, 1.054 39.3%, 1.059 44.6%, 1.053 50.2%, 1.039 56.4%, 1.013 66.7%, 1.004 76.3%, 1);
  --spring-stiff: 0.2s linear(0, 0.015, 0.059 4.4%, 0.241 9.4%, 0.839 22.8%, 1.025, 1.129 33.4%, 1.157, 1.171 38.9%, 1.171, 1.162 44.4%, 1.115 55%, 1.08 61.7%, 1.014 80%, 0.998 89.4%, 1);
  --spring-slow: 0.8s linear(0, 0.005, 0.02, 0.044 5%, 0.083 6.7%, 0.179 9.7%, 0.73 24.2%, 0.885 30.8%, 0.974 37.7%, 1.007, 1.029 44%, 1.04 47.3%, 1.045 51%, 1.041 56.3%, 1.007 78.2%, 0.998 87.7%, 1);


  /* Primary colors */
  --color-primary-50: #eff6ff;
  --color-primary-100: #dbeafe;
  --color-primary-200: #bfdbfe;
  --color-primary-300: #93c5fd;
  --color-primary-400: #60a5fa;
  --color-primary-500: #3b82f6;
  --color-primary-600: #2563eb;
  --color-primary-700: #1d4ed8;
  --color-primary-800: #1e40af;
  --color-primary-900: #1e3a8a;

  /* Error colors */
  --color-error-50: #fef2f2;
  --color-error-100: #fee2e2;
  --color-error-200: #fecaca;
  --color-error-300: #fca5a5;
  --color-error-400: #f87171;
  --color-error-500: #ef4444;
  --color-error-600: #dc2626;
  --color-error-700: #b91c1c;
  --color-error-800: #991b1b;
  --color-error-900: #7f1d1d;

  /* Gray scale */
  --color-gray-50: #f9fafb;
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-400: #9ca3af;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-gray-700: #374151;
  --color-gray-800: #1f2937;
  --color-gray-900: #111827;

  /* Semantic colors - Surface */
  --color-surface: #ffffff;
  --color-surface-hover: var(--color-gray-50);
  --color-surface-active: var(--color-gray-100);

  /* Semantic colors - Background & Foreground */
  --color-background: var(--color-gray-50);
  --color-foreground: var(--color-gray-900);
  --color-border: var(--color-gray-200);
  --color-muted: var(--color-gray-100);
  --color-muted-foreground: var(--color-gray-500);

  /* Spacing tokens */
  --spacing-xs: 0.25rem; /* 4px */
  --spacing-sm: 0.5rem; /* 8px */
  --spacing-md: 1rem; /* 16px */
  --spacing-lg: 1.5rem; /* 24px */
  --spacing-xl: 2rem; /* 32px */
  --spacing-2xl: 3rem; /* 48px */
  --spacing-3xl: 4rem; /* 64px */

  /* Border radius tokens */
  --radius-sm: 0.25rem; /* 4px */
  --radius-md: 0.5rem; /* 8px */
  --radius-lg: 0.75rem; /* 12px */
  --radius-xl: 1rem; /* 16px */
  --radius-2xl: 1.5rem; /* 24px */
  --radius-full: 9999px;

  /* Focus ring tokens */
  --focus-ring-width: 2px;
  --focus-ring-offset: 2px;
  --focus-ring-color: var(--color-primary-300);
  --focus-ring-color-error: var(--color-error-300);

  /* Table tokens */
  --table-row-hover: var(--color-gray-50);
  --table-row-selected: var(--color-primary-50);
  --table-row-selected-border: var(--color-primary-500);
  --table-header-bg: var(--color-gray-50);
  --table-header-text: var(--color-gray-500);
  --table-border: var(--color-gray-200);
}

.dark {
  /* Dark mode overrides */
  --color-surface: var(--color-gray-800);
  --color-surface-hover: var(--color-gray-700);
  --color-surface-active: var(--color-gray-600);

  --color-background: var(--color-gray-900);
  --color-foreground: var(--color-gray-50);
  --color-border: var(--color-gray-700);
  --color-muted: var(--color-gray-800);
  --color-muted-foreground: var(--color-gray-400);

  /* Table tokens - dark mode */
  --table-row-hover: rgba(31, 41, 55, 0.5); /* gray-800 with opacity */
  --table-row-selected: rgba(37, 99, 235, 0.2); /* indigo-600 with opacity */
  --table-row-selected-border: var(--color-primary-400);
  --table-header-bg: var(--color-gray-800);
  --table-header-text: var(--color-gray-400);
  --table-border: var(--color-gray-700);
}

/* Dark theme body styles */
.dark body {
  color-scheme: dark;
  background-color: var(--color-background);
  color: var(--color-foreground);
}

/* Smooth transitions for theme switching */
* {
  transition-property:
    color, background-color, border-color, text-decoration-color, fill, stroke;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* Exclude elements that use GSAP animations from global transitions */
[data-component="add-to-cart"],
[data-component="add-to-cart"] *,
[class*='gsap'],
.gsap-animated {
  transition-property: none !important;
  transition-duration: 0s !important;
}

/* Respect prefers-reduced-motion for AddToCartButton animations */
@media (prefers-reduced-motion: reduce) {
  [data-component="add-to-cart"] *,
  [data-atc-border][data-border-type="demo"]::before,
  [data-atc-border][data-border-type="animated"]::after {
    animation: none !important;
    transition: none !important;
  }
}

/* Tailwind v4 @theme for design tokens */
@theme {
  /* Button tokens */
  --btn-radius: var(--radius-md);
  --btn-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --btn-shadow-hover:
    0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --btn-transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);

  /* Card tokens */
  --card-radius: var(--radius-lg);
  --card-padding: var(--spacing-md);
  --card-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --card-shadow-hover:
    0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

  /* Semantic colors for Tailwind utilities */
  --color-surface: var(--color-surface);
  --color-surface-hover: var(--color-surface-hover);
  --color-surface-active: var(--color-surface-active);
  --color-background: var(--color-background);
  --color-foreground: var(--color-foreground);
  --color-border: var(--color-border);
  --color-muted: var(--color-muted);
  --color-muted-foreground: var(--color-muted-foreground);
}

/* Global utility classes */
@layer components {
  /* Focus ring utility - consistent focus styles across components */
  .focus-ring {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color);
    --tw-ring-offset-color: var(--color-background);
  }

  .focus-ring-error {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color-error);
    --tw-ring-offset-color: var(--color-background);
  }

  /* Card shell utility - consistent card styling */
  .card-shell {
    @apply bg-[var(--color-surface)] rounded-[var(--card-radius)] p-[var(--card-padding)] border border-[var(--color-border)];
    box-shadow: var(--card-shadow);
    /* Spring-based transition for natural hover lift */
    transition: box-shadow var(--spring-default);
  }

  .card-shell:hover {
    box-shadow: var(--card-shadow-hover);
  }

  /* Button component styles using CSS variables */
  .btn {
    @apply inline-flex items-center justify-center gap-2 font-medium;
    border-radius: var(--btn-radius);
    /* Spring-based transitions for natural feel */
    transition: 
      background-color var(--spring-snappy),
      color var(--spring-snappy),
      border-color var(--spring-snappy),
      box-shadow var(--spring-default),
      transform var(--spring-snappy);
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color);
    --tw-ring-offset-color: var(--color-background);
    @apply disabled:opacity-50 disabled:pointer-events-none;
    @apply enabled:active:scale-[0.98];
  }

  /* Override focus ring for destructive variant */
  .btn[data-variant='destructive'] {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color-error);
    --tw-ring-offset-color: var(--color-background);
  }

  /* Respect prefers-reduced-motion */
  @media (prefers-reduced-motion: reduce) {
    .btn {
      @apply transition-none active:scale-100;
    }
  }

  /* Variants using data attributes */
  .btn[data-variant='primary'] {
    @apply bg-[var(--color-primary-600)] text-[var(--color-gray-50)] hover:bg-[var(--color-primary-700)] hover:shadow-[var(--btn-shadow-hover)] dark:hover:bg-[var(--color-primary-500)];
    box-shadow: var(--btn-shadow);
  }

  .btn[data-variant='secondary'] {
    background-color: color-mix(
      in srgb,
      var(--color-primary-600) 10%,
      transparent
    );
    @apply text-[var(--color-primary-700)] dark:bg-[color-mix(in_srgb,var(--color-primary-400)_10%,transparent)] dark:text-[var(--color-primary-300)] hover:bg-[color-mix(in_srgb,var(--color-primary-600)_20%,transparent)] dark:hover:bg-[color-mix(in_srgb,var(--color-primary-400)_20%,transparent)];
  }

  .btn[data-variant='outline'] {
    @apply border border-[var(--color-gray-300)] dark:border-[var(--color-gray-700)] bg-transparent text-[var(--color-foreground)] hover:bg-[var(--color-muted)];
  }

  .btn[data-variant='ghost'] {
    @apply bg-transparent text-[var(--color-foreground)] hover:bg-[var(--color-muted)];
  }

  .btn[data-variant='link'] {
    @apply bg-transparent text-[var(--color-primary-600)] dark:text-[var(--color-primary-400)] underline-offset-4 hover:underline p-0 h-auto active:scale-100;
    box-shadow: none;
  }

  .btn[data-variant='destructive'] {
    @apply bg-[var(--color-error-600)] text-[var(--color-gray-50)] hover:bg-[var(--color-error-700)] hover:shadow-[var(--btn-shadow-hover)] dark:hover:bg-[var(--color-error-500)];
    box-shadow: var(--btn-shadow);
    --tw-ring-color: var(--color-error-300);
  }

  /* Sizes */
  .btn[data-size='sm'] {
    @apply h-8 px-3 text-xs;
  }

  .btn[data-size='md'] {
    @apply h-10 px-4 text-sm;
  }

  .btn[data-size='lg'] {
    @apply h-12 px-6 text-base;
  }

  .btn[data-size='icon'] {
    @apply h-10 w-10 p-0;
  }

  /* Icon positioning */
  .btn[data-icon='left'] {
    @apply flex-row;
  }

  .btn[data-icon='right'] {
    @apply flex-row-reverse;
  }

  .btn[data-icon='only'] {
    @apply gap-0;
  }

  /* Ensure icons are properly aligned */
  .btn svg,
  .btn [class*='MuiSvgIcon'] {
    @apply block;
  }
}

/* Button state utilities */
@layer utilities {
  .btn-loading {
    @apply relative pointer-events-none;
  }

  .btn-spinner {
    @apply animate-spin;

    @media (prefers-reduced-motion: reduce) {
      @apply animate-none;
    }
  }

  /* When loading, show spinner and hide other content */
  .btn-loading > span:not(.btn-spinner) {
    @apply opacity-0;
  }
}

/* Custom Typography/Prose preset for Shortlink */
@layer components {
  .prose-shortlink {
    @apply max-w-none;
    color: var(--color-foreground);
    /* Base typography styles - prose equivalent */
    @apply text-base leading-7;
  }

  .prose-shortlink :where(h1, h2, h3, h4, h5, h6) {
    color: var(--color-foreground);
    font-weight: 600;
  }

  .prose-shortlink :where(a) {
    color: var(--color-primary-600);
    text-decoration: none;
    transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .prose-shortlink :where(a:hover) {
    color: var(--color-primary-700);
    text-decoration: underline;
  }

  .prose-shortlink :where(ul, ol) {
    margin-top: 1.25em;
    margin-bottom: 1.25em;
    padding-left: 1.625em;
  }

  .prose-shortlink :where(li) {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }

  .prose-shortlink :where(blockquote) {
    border-left-color: var(--color-primary-300);
    color: var(--color-muted-foreground);
  }

  .prose-shortlink :where(code) {
    background-color: var(--color-muted);
    color: var(--color-foreground);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
  }

  .prose-shortlink :where(pre) {
    background-color: var(--color-muted);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
  }

  /* Dark mode adjustments */
  .dark .prose-shortlink :where(a) {
    color: var(--color-primary-400);
  }

  .dark .prose-shortlink :where(a:hover) {
    color: var(--color-primary-300);
  }

  .dark .prose-shortlink :where(blockquote) {
    border-left-color: var(--color-primary-500);
  }
}

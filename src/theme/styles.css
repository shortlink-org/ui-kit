@import 'tailwindcss';

/* CSS Variables for Theme Colors (Tailwind v4 approach) */
:root {
  /* Primary colors */
  --color-primary-50: #eff6ff;
  --color-primary-100: #dbeafe;
  --color-primary-200: #bfdbfe;
  --color-primary-300: #93c5fd;
  --color-primary-400: #60a5fa;
  --color-primary-500: #3b82f6;
  --color-primary-600: #2563eb;
  --color-primary-700: #1d4ed8;
  --color-primary-800: #1e40af;
  --color-primary-900: #1e3a8a;

  /* Error colors */
  --color-error-50: #fef2f2;
  --color-error-100: #fee2e2;
  --color-error-200: #fecaca;
  --color-error-300: #fca5a5;
  --color-error-400: #f87171;
  --color-error-500: #ef4444;
  --color-error-600: #dc2626;
  --color-error-700: #b91c1c;
  --color-error-800: #991b1b;
  --color-error-900: #7f1d1d;

  /* Gray scale */
  --color-gray-50: #f9fafb;
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-400: #9ca3af;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-gray-700: #374151;
  --color-gray-800: #1f2937;
  --color-gray-900: #111827;

  /* Semantic colors - Surface */
  --color-surface: #ffffff;
  --color-surface-hover: var(--color-gray-50);
  --color-surface-active: var(--color-gray-100);

  /* Semantic colors - Background & Foreground */
  --color-background: var(--color-gray-50);
  --color-foreground: var(--color-gray-900);
  --color-border: var(--color-gray-200);
  --color-muted: var(--color-gray-100);
  --color-muted-foreground: var(--color-gray-500);

  /* Spacing tokens */
  --spacing-xs: 0.25rem; /* 4px */
  --spacing-sm: 0.5rem; /* 8px */
  --spacing-md: 1rem; /* 16px */
  --spacing-lg: 1.5rem; /* 24px */
  --spacing-xl: 2rem; /* 32px */
  --spacing-2xl: 3rem; /* 48px */
  --spacing-3xl: 4rem; /* 64px */

  /* Border radius tokens */
  --radius-sm: 0.25rem; /* 4px */
  --radius-md: 0.5rem; /* 8px */
  --radius-lg: 0.75rem; /* 12px */
  --radius-xl: 1rem; /* 16px */
  --radius-2xl: 1.5rem; /* 24px */
  --radius-full: 9999px;

  /* Focus ring tokens */
  --focus-ring-width: 2px;
  --focus-ring-offset: 2px;
  --focus-ring-color: var(--color-primary-300);
  --focus-ring-color-error: var(--color-error-300);

  /* Table tokens */
  --table-row-hover: var(--color-gray-50);
  --table-row-selected: var(--color-primary-50);
  --table-row-selected-border: var(--color-primary-500);
  --table-header-bg: var(--color-gray-50);
  --table-header-text: var(--color-gray-500);
  --table-border: var(--color-gray-200);
}

.dark {
  /* Dark mode overrides */
  --color-surface: var(--color-gray-800);
  --color-surface-hover: var(--color-gray-700);
  --color-surface-active: var(--color-gray-600);

  --color-background: var(--color-gray-900);
  --color-foreground: var(--color-gray-50);
  --color-border: var(--color-gray-700);
  --color-muted: var(--color-gray-800);
  --color-muted-foreground: var(--color-gray-400);

  /* Table tokens - dark mode */
  --table-row-hover: rgba(31, 41, 55, 0.5); /* gray-800 with opacity */
  --table-row-selected: rgba(37, 99, 235, 0.2); /* indigo-600 with opacity */
  --table-row-selected-border: var(--color-primary-400);
  --table-header-bg: var(--color-gray-800);
  --table-header-text: var(--color-gray-400);
  --table-border: var(--color-gray-700);
}

/* Dark theme body styles */
.dark body {
  color-scheme: dark;
  background-color: var(--color-background);
  color: var(--color-foreground);
}

/* Smooth transitions for theme switching */
* {
  transition-property:
    color, background-color, border-color, text-decoration-color, fill, stroke;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* Exclude elements that use GSAP animations from global transitions */
.atc-wrapper,
.atc-wrapper *,
[class*='gsap'],
.gsap-animated {
  transition-property: none !important;
  transition-duration: 0s !important;
}

/* Respect prefers-reduced-motion for AddToCartButton animations */
@media (prefers-reduced-motion: reduce) {
  .atc-wrapper *,
  .atc__border--demo::before,
  .atc__border--animated::after {
    animation: none !important;
    transition: none !important;
  }
}

/* Tailwind v4 @theme for design tokens */
@theme {
  /* Button tokens */
  --btn-radius: var(--radius-md);
  --btn-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --btn-shadow-hover:
    0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --btn-transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1);

  /* Card tokens */
  --card-radius: var(--radius-lg);
  --card-padding: var(--spacing-md);
  --card-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
  --card-shadow-hover:
    0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

  /* Semantic colors for Tailwind utilities */
  --color-surface: var(--color-surface);
  --color-surface-hover: var(--color-surface-hover);
  --color-surface-active: var(--color-surface-active);
  --color-background: var(--color-background);
  --color-foreground: var(--color-foreground);
  --color-border: var(--color-border);
  --color-muted: var(--color-muted);
  --color-muted-foreground: var(--color-muted-foreground);
}

/* Global utility classes */
@layer components {
  /* Focus ring utility - consistent focus styles across components */
  .focus-ring {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color);
    --tw-ring-offset-color: var(--color-background);
  }

  .focus-ring-error {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color-error);
    --tw-ring-offset-color: var(--color-background);
  }

  /* Card shell utility - consistent card styling */
  .card-shell {
    @apply bg-[var(--color-surface)] rounded-[var(--card-radius)] p-[var(--card-padding)] border border-[var(--color-border)];
    box-shadow: var(--card-shadow);
    @apply transition-shadow duration-150 ease-in-out;
  }

  .card-shell:hover {
    box-shadow: var(--card-shadow-hover);
  }

  /* Button component styles using CSS variables */
  .btn {
    @apply inline-flex items-center justify-center gap-2 font-medium;
    border-radius: var(--btn-radius);
    @apply transition-all duration-150 ease-in-out;
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color);
    --tw-ring-offset-color: var(--color-background);
    @apply disabled:opacity-50 disabled:pointer-events-none;
    @apply enabled:active:scale-[0.98];
  }

  /* Override focus ring for destructive variant */
  .btn[data-variant='destructive'] {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2;
    --tw-ring-color: var(--focus-ring-color-error);
    --tw-ring-offset-color: var(--color-background);
  }

  /* Respect prefers-reduced-motion */
  @media (prefers-reduced-motion: reduce) {
    .btn {
      @apply transition-none active:scale-100;
    }
  }

  /* Variants using data attributes */
  .btn[data-variant='primary'] {
    @apply bg-[var(--color-primary-600)] text-[var(--color-gray-50)] hover:bg-[var(--color-primary-700)] hover:shadow-[var(--btn-shadow-hover)] dark:hover:bg-[var(--color-primary-500)];
    box-shadow: var(--btn-shadow);
  }

  .btn[data-variant='secondary'] {
    background-color: color-mix(
      in srgb,
      var(--color-primary-600) 10%,
      transparent
    );
    @apply text-[var(--color-primary-700)] dark:bg-[color-mix(in_srgb,var(--color-primary-400)_10%,transparent)] dark:text-[var(--color-primary-300)] hover:bg-[color-mix(in_srgb,var(--color-primary-600)_20%,transparent)] dark:hover:bg-[color-mix(in_srgb,var(--color-primary-400)_20%,transparent)];
  }

  .btn[data-variant='outline'] {
    @apply border border-[var(--color-gray-300)] dark:border-[var(--color-gray-700)] bg-transparent text-[var(--color-foreground)] hover:bg-[var(--color-muted)];
  }

  .btn[data-variant='ghost'] {
    @apply bg-transparent text-[var(--color-foreground)] hover:bg-[var(--color-muted)];
  }

  .btn[data-variant='link'] {
    @apply bg-transparent text-[var(--color-primary-600)] dark:text-[var(--color-primary-400)] underline-offset-4 hover:underline p-0 h-auto active:scale-100;
    box-shadow: none;
  }

  .btn[data-variant='destructive'] {
    @apply bg-[var(--color-error-600)] text-[var(--color-gray-50)] hover:bg-[var(--color-error-700)] hover:shadow-[var(--btn-shadow-hover)] dark:hover:bg-[var(--color-error-500)];
    box-shadow: var(--btn-shadow);
    --tw-ring-color: var(--color-error-300);
  }

  /* Sizes */
  .btn[data-size='sm'] {
    @apply h-8 px-3 text-xs;
  }

  .btn[data-size='md'] {
    @apply h-10 px-4 text-sm;
  }

  .btn[data-size='lg'] {
    @apply h-12 px-6 text-base;
  }

  .btn[data-size='icon'] {
    @apply h-10 w-10 p-0;
  }

  /* Icon positioning */
  .btn[data-icon='left'] {
    @apply flex-row;
  }

  .btn[data-icon='right'] {
    @apply flex-row-reverse;
  }

  .btn[data-icon='only'] {
    @apply gap-0;
  }

  /* Ensure icons are properly aligned */
  .btn svg,
  .btn [class*='MuiSvgIcon'] {
    @apply block;
  }
}

/* Button state utilities */
@layer utilities {
  .btn-loading {
    @apply relative pointer-events-none;
  }

  .btn-spinner {
    @apply animate-spin;

    @media (prefers-reduced-motion: reduce) {
      @apply animate-none;
    }
  }

  /* When loading, show spinner and hide other content */
  .btn-loading > span:not(.btn-spinner) {
    @apply opacity-0;
  }
}

/* Custom Typography/Prose preset for Shortlink */
@layer components {
  .prose-shortlink {
    @apply max-w-none;
    color: var(--color-foreground);
    /* Base typography styles - prose equivalent */
    @apply text-base leading-7;
  }

  .prose-shortlink :where(h1, h2, h3, h4, h5, h6) {
    color: var(--color-foreground);
    font-weight: 600;
  }

  .prose-shortlink :where(a) {
    color: var(--color-primary-600);
    text-decoration: none;
    transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .prose-shortlink :where(a:hover) {
    color: var(--color-primary-700);
    text-decoration: underline;
  }

  .prose-shortlink :where(ul, ol) {
    margin-top: 1.25em;
    margin-bottom: 1.25em;
    padding-left: 1.625em;
  }

  .prose-shortlink :where(li) {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }

  .prose-shortlink :where(blockquote) {
    border-left-color: var(--color-primary-300);
    color: var(--color-muted-foreground);
  }

  .prose-shortlink :where(code) {
    background-color: var(--color-muted);
    color: var(--color-foreground);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
  }

  .prose-shortlink :where(pre) {
    background-color: var(--color-muted);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
  }

  /* Dark mode adjustments */
  .dark .prose-shortlink :where(a) {
    color: var(--color-primary-400);
  }

  .dark .prose-shortlink :where(a:hover) {
    color: var(--color-primary-300);
  }

  .dark .prose-shortlink :where(blockquote) {
    border-left-color: var(--color-primary-500);
  }
}

/**
 * Drawer component styles
 * 
 * Uses CSS @layer for cascade control and @scope for style isolation.
 * Layer order: base → component → variants → theme → animation
 */

/* Define layer order for this component */
@layer drawer.base, drawer.component, drawer.variants, drawer.theme, drawer.animation;

/* Base layer: Reset and foundational styles */
@layer drawer.base {
  @scope ([data-component="drawer"]) {
    /* Overlay base */
    :scope [data-drawer-overlay] {
      position: fixed;
      inset: 0;
      z-index: 40;
    }

    /* Panel base */
    :scope [data-drawer-panel] {
      position: fixed;
      z-index: 50;
      display: flex;
      flex-direction: column;
      outline: none;
    }

    /* Inner container base */
    :scope [data-drawer-inner] {
      position: relative;
      display: flex;
      flex-direction: column;
      height: 100%;
      min-height: 0;
      overflow: hidden;
    }

    /* Close button base */
    :scope [data-drawer-close] {
      position: absolute;
      top: 1rem;
      right: 1rem;
      z-index: 10;
    }

    /* Content area base */
    :scope [data-drawer-content] {
      position: relative;
      flex: 1;
      min-height: 0;
      padding-inline: 1rem;
    }

    @media (min-width: 640px) {
      :scope [data-drawer-content] {
        padding-inline: 1.5rem;
      }
    }

    /* Title base */
    :scope [data-drawer-title] {
      font-size: 1rem;
      font-weight: 600;
    }

    /* Handle base */
    :scope [data-drawer-handle] {
      margin-inline: auto;
      margin-bottom: 1rem;
      height: 0.375rem;
      width: 3rem;
      flex-shrink: 0;
      cursor: grab;
    }

    :scope [data-drawer-handle]:active {
      cursor: grabbing;
    }
  }
}

/* Component layer: Core visual styles */
@layer drawer.component {
  @scope ([data-component="drawer"]) {
    /* Overlay appearance */
    :scope [data-drawer-overlay] {
      background-color: rgb(107 114 128 / 0.75);
    }

    :scope [data-drawer-overlay][data-state="closed"] {
      opacity: 0;
    }

    /* Inner container appearance */
    :scope [data-drawer-inner] {
      border-radius: var(--radius-2xl, 1rem);
      box-shadow:
        0 20px 25px -5px rgb(0 0 0 / 0.1),
        0 8px 10px -6px rgb(0 0 0 / 0.1);
    }

    /* Close button appearance */
    :scope [data-drawer-close] {
      border-radius: var(--radius-md, 0.375rem);
    }

    :scope [data-drawer-close]:focus-visible {
      outline: 2px solid var(--color-primary-600, #2563eb);
      outline-offset: 2px;
    }

    /* Handle appearance */
    :scope [data-drawer-handle] {
      border-radius: var(--radius-full, 9999px);
    }
  }
}

/* Variants layer: Position and size variants */
@layer drawer.variants {
  @scope ([data-component="drawer"]) {
    /* === Position Variants === */

    /* Side drawer (left/right) common styles */
    :scope [data-drawer-panel][data-position="left"],
    :scope [data-drawer-panel][data-position="right"] {
      background: transparent;
      box-shadow: none;
      inset-block: 0.5rem;
      width: calc(100% - 1rem);
      border-radius: var(--radius-2xl, 1rem);
    }

    /* Right drawer */
    :scope [data-drawer-panel][data-position="right"] {
      right: 0.5rem;
    }

    :scope [data-drawer-panel][data-position="right"][data-state="closed"] {
      transform: translateX(100%);
    }

    /* Left drawer */
    :scope [data-drawer-panel][data-position="left"] {
      left: 0.5rem;
    }

    :scope [data-drawer-panel][data-position="left"][data-state="closed"] {
      transform: translateX(-100%);
    }

    /* Bottom drawer */
    :scope [data-drawer-panel][data-position="bottom"] {
      box-shadow:
        0 -10px 15px -3px rgb(0 0 0 / 0.1),
        0 -4px 6px -4px rgb(0 0 0 / 0.1);
      inset-inline: 0;
      bottom: 0;
      width: 100%;
      border-radius: var(--radius-2xl, 1rem) var(--radius-2xl, 1rem) 0 0;
    }

    :scope [data-drawer-panel][data-position="bottom"][data-state="closed"] {
      transform: translateY(100%);
    }

    /* === Size Variants (Side drawers) === */
    :scope [data-drawer-panel][data-size="sm"] {
      max-width: 24rem;
    }

    :scope [data-drawer-panel][data-size="md"] {
      max-width: 28rem;
    }

    :scope [data-drawer-panel][data-size="lg"] {
      max-width: 32rem;
    }

    :scope [data-drawer-panel][data-size="xl"] {
      max-width: 36rem;
    }

    :scope [data-drawer-panel][data-size="full"] {
      max-width: 100%;
    }

    /* === Size Variants (Bottom drawer) === */
    :scope [data-drawer-panel][data-position="bottom"][data-size="sm"] {
      height: 40vh;
      max-height: 40vh;
    }

    :scope [data-drawer-panel][data-position="bottom"][data-size="md"] {
      height: 60vh;
      max-height: 60vh;
    }

    :scope [data-drawer-panel][data-position="bottom"][data-size="lg"] {
      height: 75vh;
      max-height: 75vh;
    }

    :scope [data-drawer-panel][data-position="bottom"][data-size="xl"] {
      height: 85vh;
      max-height: 85vh;
    }

    :scope [data-drawer-panel][data-position="bottom"][data-size="full"] {
      height: 100vh;
      max-height: 100vh;
    }

    /* === Scrollable Variant === */
    :scope [data-drawer-content][data-scrollable="true"] {
      overflow-y: auto;
    }

    :scope [data-drawer-content][data-scrollable="false"] {
      overflow: hidden;
    }
  }
}

/* Theme layer: Colors for light/dark mode */
@layer drawer.theme {
  @scope ([data-component="drawer"]) {
    /* Light mode (default) */
    :scope [data-drawer-panel][data-position="bottom"] {
      background-color: var(--color-surface, #fff);
    }

    :scope [data-drawer-inner] {
      background-color: var(--color-surface, #fff);
    }

    :scope [data-drawer-close] {
      color: var(--color-gray-400, #9ca3af);
    }

    :scope [data-drawer-close]:hover {
      color: var(--color-gray-600, #4b5563);
    }

    :scope [data-drawer-title] {
      color: var(--color-foreground, #111827);
    }

    :scope [data-drawer-handle] {
      background-color: var(--color-gray-300, #d1d5db);
    }

    /* Dark mode */
    .dark :scope [data-drawer-panel][data-position="bottom"] {
      background-color: var(--color-gray-900, #111827);
    }

    .dark :scope [data-drawer-inner] {
      background-color: var(--color-gray-900, #111827);
    }

    .dark :scope [data-drawer-close]:hover {
      color: var(--color-gray-200, #e5e7eb);
    }

    .dark :scope [data-drawer-title] {
      color: var(--color-gray-50, #f9fafb);
    }

    .dark :scope [data-drawer-handle] {
      background-color: var(--color-gray-600, #4b5563);
    }
  }
}

/* Animation layer: Spring-based transitions using Motion's linear() easing */
/* @see https://motion.dev/tutorials/react-css-spring */
@layer drawer.animation {
  @scope ([data-component="drawer"]) {
    /* Overlay fade - gentle spring for smooth appearance */
    :scope [data-drawer-overlay] {
      transition: opacity var(--spring-gentle);
    }

    /* Panel slide - bouncy spring for natural drawer feel */
    :scope [data-drawer-panel] {
      transition: transform var(--spring-bouncy);
    }

    /* Close button color transition - snappy spring */
    :scope [data-drawer-close] {
      transition: color var(--spring-snappy);
    }
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    @scope ([data-component="drawer"]) {
      :scope [data-drawer-overlay],
      :scope [data-drawer-panel],
      :scope [data-drawer-close] {
        transition: none;
      }
    }
  }
}
